<div class="pl-2 pb-3">
  <h1>Előző edzéseim</h1>
</div>

<div class="pl-2 pb-6">
  <span>
    Ezen az oldalon tekintheti meg az előző edzéseit, valamint felvehet új
    edzést!
  </span>
</div>

<div class="card">
  <p-toolbar styleClass="mb-4 gap-2">
    <button
      pButton
      pRipple
      label="Új edzés hozzáadása"
      icon="pi pi-plus"
      class="p-button-success mr-2"
      (click)="openNew()"
    ></button>
  </p-toolbar>
  <p-table
    [value]="exerciseList | async"
    [tableStyle]="{ 'min-width': '50rem' }"
    styleClass="p-datatable-striped"
  >
    <ng-template pTemplate="header">
      <tr>
        <th>Időpont</th>
        <th>Edzés típus</th>
        <th>Csoportos edzés típus</th>
        <th>Gép</th>
        <th>Súly (kg)</th>
        <th>Ismétlés</th>
        <th>Intenzitás (1-10)</th>
        <th>Időtartam (perc)</th>
        <th></th>
      </tr>
    </ng-template>
    <ng-template
      pTemplate="body"
      let-exercise
      let-editing="editing"
      let-ri="rowIndex"
    >
      <tr>
        <td>{{ exercise.date }}</td>

        <td>{{ exercise.type }}</td>

        <td>{{ exercise.groupTrainingType }}</td>

        <td>{{ exercise.machine?.name }}</td>

        <td>{{ exercise.weight }}</td>

        <td>{{ exercise.count }}</td>

        <td>{{ exercise.intensity }}</td>

        <td>{{ exercise.duration }}</td>

        <td>
          <button
            pButton
            pRipple
            class="p-button-text"
            (click)="deleteExercise(exercise)"
          >
            Törlés
          </button>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>
<form #newExerciseForm="ngForm">
  <p-dialog
    [(visible)]="newExerciseDialog"
    [style]="{ width: '450px' }"
    header="Új edzés hozzáadása"
    [modal]="true"
    styleClass="p-fluid"
  >
    <ng-template pTemplate="content">
      <div class="field">
        <label for="type">Típus</label>
        <p-dropdown
          [(ngModel)]="newExercise.type"
          [options]="['Egyéni', 'Csoportos']"
          name="type"
          [required]="true"
          appendTo="body"
          (ngModelChange)="typeChanged($event)"
        >
        </p-dropdown>
      </div>
      <div
        class="field"
        *ngIf="newExercise.type && newExercise.type === 'Csoportos'"
      >
        <label for="groupTrainingType">Csoportos edzés típusa</label>
        <p-dropdown
          [(ngModel)]="newExercise.groupTrainingType"
          [options]="groupTrainingTypeList"
          name="groupTrainingType"
          [required]="newExercise.type && newExercise.type === 'Csoportos'"
          appendTo="body"
        >
        </p-dropdown>
      </div>
      <div
        class="field"
        *ngIf="newExercise.type && newExercise.type === 'Egyéni'"
      >
        <label for="machine">Használt gép</label>
        <p-dropdown
          [(ngModel)]="newExercise.machine"
          [options]="machineList"
          name="machine"
          [required]="newExercise.type && newExercise.type === 'Egyéni'"
          optionLabel="name"
        >
        </p-dropdown>
      </div>
      <div
        class="field"
        *ngIf="newExercise.machine && newExercise.machine.type === 'Súlyzós'"
      >
        <label for="weight">Súly (kg)</label>
        <p-inputNumber
          type="text"
          name="weight"
          [min]="1"
          [max]="500"
          [(ngModel)]="newExercise.weight"
          [required]="
            newExercise.machine?.type && newExercise.machine?.type === 'Súlyzós'
          "
        ></p-inputNumber>
      </div>
      <div
        class="field"
        *ngIf="newExercise.machine && newExercise.machine.type === 'Súlyzós'"
      >
        <label for="count">Ismétlés</label>
        <p-inputNumber
          type="text"
          name="count"
          [min]="1"
          [max]="200"
          [(ngModel)]="newExercise.count"
          [required]="
            newExercise.machine?.type && newExercise.machine?.type === 'Súlyzós'
          "
        ></p-inputNumber>
      </div>
      <div
        class="field"
        *ngIf="newExercise.machine && newExercise.machine.type === 'Kardió'"
      >
        <label for="intensity">Intenzitás (1-10)</label>
        <p-inputNumber
          name="intensity"
          [min]="1"
          [max]="10"
          [(ngModel)]="newExercise.intensity"
          [required]="
            newExercise.machine?.type && newExercise.machine?.type === 'Kardió'
          "
        ></p-inputNumber>
      </div>
      <div
        class="field"
        *ngIf="newExercise.machine && newExercise.machine.type === 'Kardió'"
      >
        <label for="duration">Időtartam (perc)</label>
        <p-inputNumber
          name="duration"
          [(ngModel)]="newExercise.duration"
          [min]="1"
          [max]="180"
          [required]="
            newExercise.machine?.type && newExercise.machine?.type === 'Kardió'
          "
        ></p-inputNumber>
      </div>
      <div class="field">
        <label for="date">Edzés időpontja</label>
        <p-calendar
          name="date"
          [(ngModel)]="newExercise.date"
          [showIcon]="true"
          [disabled]="
            (newExercise.type === 'Egyéni' && !newExercise.machine?.type) ||
            (newExercise.type === 'Csoportos' &&
              !newExercise.groupTrainingType) ||
            !newExercise.type
          "
          required
          appendTo="body"
          [maxDate]="today"
        ></p-calendar>
      </div>
    </ng-template>
    <ng-template pTemplate="footer">
      <button
        pButton
        pRipple
        label="Mégse"
        icon="pi pi-times"
        class="p-button-text"
        (click)="hideNewDialog()"
      ></button>
      <button
        pButton
        pRipple
        label="Mentés"
        icon="pi pi-check"
        class="p-button-text"
        [disabled]="!newExerciseForm.valid"
        (click)="saveNewExercise()"
      ></button>
    </ng-template>
  </p-dialog>
</form>
<p-confirmDialog></p-confirmDialog>
